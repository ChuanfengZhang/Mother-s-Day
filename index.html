<!DOCTYPE html>
<html lang="zh-cmn-Hans">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>母亲节活动</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <link rel="stylesheet" type="text/css" href="./css/index.css">
  <link rel="stylesheet" type="text/css" href="./css/reset.css">
</head>
<body>
<section class="foreword">
  <p>她的世界很小</p>
  <p>只装满了你</p>
  <p>你的世界很大</p>
  <p>却常常忽略了她</p>
</section>
<!--引入jQuery-->
<script src="./libs/jquery-1.12.4.min.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    // 绑定页面的resize事件以在变化时更新html的font-size
    $(window).resize(setFontSize);
    checkLogin(); // 获取用户登录信息
  });
  // 设置html的font-size
  function setFontSize() {
    document.getElementsByTagName('html')[0].style.fontSize = (window.innerWidth / 375) * 100 + 'px';
  }
  // 获取用户登录信息
  function checkLogin() {
    $.ajax({
      url: "/user/getUserInfo.do",
      dataType: "json",
      type: "GET",
      success: function (data) {
        if (data.LoginTimeOut) {
          // 用户未登录
          applyWechatLogin();
        }
      },
      error: function () {
        console.log("网络错误！");
      }
    });
  }
  // 获取微信上自动注册创客贴账号的链接
  function applyWechatLogin() {
    $.ajax({
      url: "/login/webWxFWHLogin.do",
      dataType: "json",
      type: "POST",
      data: {
        redirect_url: window.location.href
      },
      success: function (data) {
        if (data.code == 1) {
          window.location.href = data.url;
        } else {
          console.log("出错啦!")
        }
      }
    });
  }
</script>
</body>
</html>